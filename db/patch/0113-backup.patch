From ab89cf614d7d68bbabd2139fe97853bda4b8a909 Mon Sep 17 00:00:00 2001
From: Sleepy_chord <sj702d5@foxmail.com>
Date: Fri, 23 Oct 2015 12:10:08 +0800
Subject: [PATCH 113/150] backup

---
 app/controllers/manage_controller.rb          |  4 ++--
 app/controllers/test_controller.rb            |  2 +-
 app/views/devise/_navigationbar.html.erb      | 14 ++++++++++++++
 app/views/layouts/application.html.erb        |  5 +++++
 app/views/layouts/main.html.erb               | 25 -------------------------
 app/views/manage/_navigationbar.html.erb      |  2 +-
 app/views/manage/student_lesson_info.html.erb |  2 +-
 app/views/test/index.html.erb                 |  5 +++++
 8 files changed, 29 insertions(+), 30 deletions(-)
 create mode 100644 app/views/devise/_navigationbar.html.erb
 delete mode 100644 app/views/layouts/main.html.erb

diff --git a/app/controllers/manage_controller.rb b/app/controllers/manage_controller.rb
index 8e33179..d7ebc87 100644
--- a/app/controllers/manage_controller.rb
+++ b/app/controllers/manage_controller.rb
@@ -1,6 +1,6 @@
 class ManageController < ApplicationController
-  layout "main"
-  #before_action :authenticate_user!
+  layout "application"
+  before_action :authenticate_user!
   def index
   end
   def main_page
diff --git a/app/controllers/test_controller.rb b/app/controllers/test_controller.rb
index e231f4e..7d2c5a3 100644
--- a/app/controllers/test_controller.rb
+++ b/app/controllers/test_controller.rb
@@ -1,5 +1,5 @@
 class TestController < ApplicationController
-  layout "main"
+  layout "application"
   def index
 
   end
diff --git a/app/views/devise/_navigationbar.html.erb b/app/views/devise/_navigationbar.html.erb
new file mode 100644
index 0000000..3f4a533
--- /dev/null
+++ b/app/views/devise/_navigationbar.html.erb
@@ -0,0 +1,14 @@
+<nav class="nav navbar-inverse" role="navigation"
+     style="padding-left: 5%;padding-right: 5%;">
+    <div class="row">
+      <div class="navbar-header">
+        <a class="navbar-brand" href="">网络原理实验管理系统</a>
+      </div>
+      <ul class="nav navbar-nav pull-right">
+          <li class="user_msg"><a id="user_name"><%= @current_user.email %></a></li>
+          <li class="user_msg">
+            <%= link_to "Sign out",destroy_user_session_path , method: :delete %>
+          </li>
+      </ul>
+    </div>
+</nav>
diff --git a/app/views/layouts/application.html.erb b/app/views/layouts/application.html.erb
index 05cdf31..1ea877c 100644
--- a/app/views/layouts/application.html.erb
+++ b/app/views/layouts/application.html.erb
@@ -7,6 +7,11 @@
   <%= csrf_meta_tags %>
 </head>
 <body>
+<%= render :partial => "navigationbar" %>
+<div id="MainContent" style="text-align: center">
 <%= yield %>
+</div>
+<%= render :partial => "footbar"%>
 </body>
+
 </html>
diff --git a/app/views/layouts/main.html.erb b/app/views/layouts/main.html.erb
deleted file mode 100644
index ed1b01f..0000000
--- a/app/views/layouts/main.html.erb
+++ /dev/null
@@ -1,25 +0,0 @@
-<!DOCTYPE html>
-<html>
-<head>
-  <title>Papdb</title>
-  <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' => true %>
-  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
-  <%= csrf_meta_tags %>
-</head>
-<body>
-<%= render :partial => "navigationbar" %>
-<div id="MainContent" style="text-align: center">
-<%= yield %>
-</div>
-<%= render :partial => "footbar"%>
-</body>
-<script>
-    (function (){
-        <% if user_signed_in?%>
-        $("#user_name").html("<%= current_user.email %>");
-        <%else%>
-        $("#MainContent").load("/users/sign_in");
-        <%end%>
-    })();
-</script>
-</html>
diff --git a/app/views/manage/_navigationbar.html.erb b/app/views/manage/_navigationbar.html.erb
index 3b1f42f..3f4a533 100644
--- a/app/views/manage/_navigationbar.html.erb
+++ b/app/views/manage/_navigationbar.html.erb
@@ -5,7 +5,7 @@
         <a class="navbar-brand" href="">网络原理实验管理系统</a>
       </div>
       <ul class="nav navbar-nav pull-right">
-          <li class="user_msg"><a id="user_name">name</a></li>
+          <li class="user_msg"><a id="user_name"><%= @current_user.email %></a></li>
           <li class="user_msg">
             <%= link_to "Sign out",destroy_user_session_path , method: :delete %>
           </li>
diff --git a/app/views/manage/student_lesson_info.html.erb b/app/views/manage/student_lesson_info.html.erb
index 8e779be..22bb875 100644
--- a/app/views/manage/student_lesson_info.html.erb
+++ b/app/views/manage/student_lesson_info.html.erb
@@ -33,7 +33,7 @@
             <form method="post" name="student_comment" target="" id="teacher-form"
                   action="/lessons/<%=@lesson.id %>/students/<%=@student.id %>/comments.json"
                   onsubmit="return submit_form()">
-              <input name="_method" type="hidden" value="put" />
+              <!--input name="_method" type="hidden" value="put" /-->
               <div class="col-md-6">
                   <div class="input-group">
                     <span class="input-group-addon">学生得分</span>
diff --git a/app/views/test/index.html.erb b/app/views/test/index.html.erb
index e8dd517..1dbf040 100644
--- a/app/views/test/index.html.erb
+++ b/app/views/test/index.html.erb
@@ -6,3 +6,8 @@
   <label>type<input name="file[type]" type="text"></label>
   <button type="submit" >submit</button>
 </form>
+
+<form action="/courses/1/teachers/1.json" method="post">
+  <button type="submit">add teacher</button>
+</form>
+
-- 
1.9.1

