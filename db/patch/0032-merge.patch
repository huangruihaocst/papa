From 99985c08d798a99ae35ed7155823b5d11abd977d Mon Sep 17 00:00:00 2001
From: sleepy_chord <sj702d5@foxmail.com>
Date: Wed, 7 Oct 2015 14:55:35 +0800
Subject: [PATCH 032/150] merge

---
 app/controllers/manage_controller.rb | 14 ++++++++++++++
 app/views/layouts/main.html.erb      |  4 ++--
 config/routes.rb                     |  2 ++
 db/schema.rb                         |  3 +--
 4 files changed, 19 insertions(+), 4 deletions(-)

diff --git a/app/controllers/manage_controller.rb b/app/controllers/manage_controller.rb
index c6cd4be..750f9a1 100644
--- a/app/controllers/manage_controller.rb
+++ b/app/controllers/manage_controller.rb
@@ -19,4 +19,18 @@ class ManageController < ApplicationController
   end
   def ShowVideos
   end
+  def GetUserCoursesById
+    reqId=params[:id]
+    render :json => User.find(reqId).courses.to_json
+  end
+  def AddCourseToCurrentUser
+    if(user_signed_in?)
+      uId=@current_user.id;
+      c=Course.where("name = ?",params[:name]).first;
+      if(not c)
+        c=Course.create(name: params[:name],description : params[:description])
+      end
+
+    end
+  end
 end
diff --git a/app/views/layouts/main.html.erb b/app/views/layouts/main.html.erb
index ed1b01f..8b96323 100644
--- a/app/views/layouts/main.html.erb
+++ b/app/views/layouts/main.html.erb
@@ -15,11 +15,11 @@
 </body>
 <script>
     (function (){
-        <% if user_signed_in?%>
+      /*  <% if user_signed_in?%>
         $("#user_name").html("<%= current_user.email %>");
         <%else%>
         $("#MainContent").load("/users/sign_in");
-        <%end%>
+        <%end%>*/
     })();
 </script>
 </html>
diff --git a/config/routes.rb b/config/routes.rb
index 0838356..b5bfd8a 100644
--- a/config/routes.rb
+++ b/config/routes.rb
@@ -21,6 +21,8 @@ Rails.application.routes.draw do
   get 'manage/CourseInfo' => 'manage#course_info'
   get 'manage/ShowPhotos' => 'manage#show_photos'
   get 'manage/ShowVideos' => 'manage#show_videos'
+
+  get 'manage/getUserCoursesById/:id' => 'manage#GetUserCoursesById'
   # Example of named route that can be invoked with purchase_url(id: product.id)
   #   get 'products/:id/purchase' => 'catalog#purchase', as: :purchase
 
diff --git a/db/schema.rb b/db/schema.rb
index 41c53bb..dce4f6f 100644
--- a/db/schema.rb
+++ b/db/schema.rb
@@ -23,7 +23,7 @@ ActiveRecord::Schema.define(version: 20150930115150) do
     t.text     "description"
     t.datetime "start_time"
     t.datetime "end_time"
-    t.string   "location"
+    t.string   "position"
     t.integer  "course_id"
   end
 
@@ -46,7 +46,6 @@ ActiveRecord::Schema.define(version: 20150930115150) do
     t.datetime "last_sign_in_at"
     t.string   "current_sign_in_ip"
     t.string   "last_sign_in_ip"
-    t.boolean  "is_teacher"
     t.datetime "created_at",                          null: false
     t.datetime "updated_at",                          null: false
   end
-- 
1.9.1

